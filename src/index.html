<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expense Tracker</title>

  <!-- Main styles first -->
  <link rel="stylesheet" href="styles.css">

  <!-- Dark theme overrides loaded after main styles -->
  <link rel="stylesheet" href="styles/dark-theme.css">

  <!-- Load XLSX library for Excel file support -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <!-- Hamburger Menu Button - Fixed structure -->
  <button class="hamburger-menu" id="hamburgerMenu">
    <div class="hamburger-line"></div>
    <div class="hamburger-line"></div>
    <div class="hamburger-line"></div>
  </button>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-content">
      <h2>Tools & Settings</h2>

      <!-- File Management -->
      <div class="action-buttons">
        <button id="fileUploadBtn" class="action-button" title="Upload Transaction File">
          <span class="action-icon">📁</span>
          <span class="action-text">Upload</span>
        </button>

        <button id="showMergedFilesBtn" class="action-button" title="View Merged Files">
          <span class="action-icon">📊</span>
          <span class="action-text">Merged Files</span>
        </button>

        <button id="showMappingsBtn" class="action-button" title="Manage Format Mappings">
          <span class="action-icon">🗂️</span>
          <span class="action-text">Mappings</span>
        </button>

        <button id="editCategoriesSidebarBtn" class="action-button" title="Manage Categories">
          <span class="action-icon">🏷️</span>
          <span class="action-text">Edit Categories</span>
        </button>

        <button id="exportBtn" class="action-button" title="Export Data">
          <span class="action-icon">💾</span>
          <span class="action-text">Export</span>
        </button>
      </div>

      <!-- Settings Section -->
      <div class="sidebar-section">
        <h3>Settings</h3>

        <div class="toggle-item">
          <label for="darkModeToggle">Dark Mode</label>
          <div class="toggle-switch">
            <input type="checkbox" id="darkModeToggle">
            <span class="slider"></span>
          </div>
        </div>

        <div class="toggle-item">
          <label for="debugModeToggle">Debug Mode</label>
          <div class="toggle-switch">
            <input type="checkbox" id="debugModeToggle">
            <span class="slider"></span>
          </div>
        </div>
      </div>

      <!-- Debug Tools Section -->
      <div class="sidebar-section debug-only" id="debugToolsSection">
        <h3>Debug Tools</h3>

        <div class="debug-action-buttons">
          <button id="debugFilesBtn" class="debug-action-button">
            <span class="action-icon">🗂️</span>
            <span class="action-text">Debug Files</span>
          </button>

          <button id="debugSignaturesBtn" class="debug-action-button">
            <span class="action-icon">🔍</span>
            <span class="action-text">Debug Signatures</span>
          </button>

          <button id="debugTransactionsBtn" class="debug-action-button">
            <span class="action-icon">📊</span>
            <span class="action-text">Debug Transactions</span>
          </button>

          <button id="saveLogBtn" class="debug-action-button">
            <span class="action-icon">💾</span>
            <span class="action-text">Save Log</span>
          </button>

          <button id="resetAppBtn" class="debug-action-button danger">
            <span class="action-icon">🔄</span>
            <span class="action-text">Reset App</span>
          </button>
        </div>
      </div>

      <!-- About -->
      <div class="sidebar-section">
        <p>Expense Tracker v1.0</p>
        <p>Manage your finances locally</p>
      </div>
    </div>
  </aside>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Main Content -->
  <main class="main-content" id="mainContent">
    <!-- Charts Section -->
    <div class="section">
      <div class="section-header">
        <h2>📊 Financial Overview</h2>
        <div class="section-actions">
          <div class="chart-controls">
            <button class="chart-toggle-btn active" data-chart="expense" title="Toggle Expense Chart">
              <span class="action-icon">🥧</span>
              <span class="action-text">Expenses</span>
            </button>
            <button class="chart-toggle-btn active" data-chart="incomeExpense" title="Toggle Income/Expense Chart">
              <span class="action-icon">📊</span>
              <span class="action-text">Overview</span>
            </button>
            <button class="chart-toggle-btn active" data-chart="timeline" title="Toggle Timeline Chart">
              <span class="action-icon">📈</span>
              <span class="action-text">Timeline</span>
            </button>
          </div>
        </div>
      </div>

      <div class="section-content">
        <div class="charts-section">
          <div id="expenseChartWrapper" class="chart-wrapper">
            <h3>Expenses by Category</h3>
            <div class="chart-container">
              <canvas id="expenseChart"></canvas>
            </div>
          </div>

          <div id="incomeExpenseChartWrapper" class="chart-wrapper">
            <h3>Income vs Expenses</h3>
            <div class="chart-container">
              <canvas id="incomeExpenseChart"></canvas>
            </div>
          </div>

          <div id="timelineChartWrapper" class="chart-wrapper">
            <h3>Financial Timeline</h3>
            <div class="chart-container">
              <canvas id="timelineChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Transactions Section -->
    <div class="section" id="transactionsSection">
      <div class="section-header">
        <h2>💰 Transactions</h2>
        <div class="section-actions">
          <!-- Export functionality is available through the sidebar export button -->
        </div>
      </div>

      <div class="section-content">
        <!-- Transaction Table Container -->
        <div id="transactionTableContainer" class="transaction-table-container">
          <!-- Transactions will be rendered here -->
        </div>
      </div>
    </div>
  </main>

  <!-- Load main application -->
  <script type="module" src="main.js"></script>
</body>

</html>
