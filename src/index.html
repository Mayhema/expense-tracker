<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expense Tracker</title>

  <!-- Main styles first -->
  <link rel="stylesheet" href="styles.css">

  <!-- Dark theme overrides loaded after main styles -->
  <link rel="stylesheet" href="styles/dark-theme.css">

  <!-- Load XLSX library for Excel file support -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <!-- Hamburger Menu Button - Fixed structure -->
  <button class="hamburger-menu" id="hamburgerMenu">
    <div class="hamburger-line"></div>
    <div class="hamburger-line"></div>
    <div class="hamburger-line"></div>
  </button>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-content">
      <h2>Tools & Settings</h2>

      <!-- File Management -->
      <div class="action-buttons">
        <button id="fileUploadBtn" class="action-button" title="Upload Transaction File">
          <span class="action-icon">📁</span>
          <span class="action-text">Upload</span>
        </button>

        <button id="showMergedFilesBtn" class="action-button" title="View Merged Files">
          <span class="action-icon">📊</span>
          <span class="action-text">Merged Files</span>
        </button>

        <button id="showMappingsBtn" class="action-button" title="Manage Format Mappings">
          <span class="action-icon">🗂️</span>
          <span class="action-text">Mappings</span>
        </button>

        <button id="editCategoriesSidebarBtn" class="action-button" title="Manage Categories">
          <span class="action-icon">🏷️</span>
          <span class="action-text">Edit Categories</span>
        </button>

        <button id="exportBtn" class="action-button" title="Export Data">
          <span class="action-icon">💾</span>
          <span class="action-text">Export</span>
        </button>
      </div>

      <!-- Settings Section -->
      <div class="sidebar-section">
        <h3>Settings</h3>

        <div class="toggle-item">
          <label for="darkModeToggle">Dark Mode</label>
          <div class="toggle-switch">
            <input type="checkbox" id="darkModeToggle">
            <span class="slider"></span>
          </div>
        </div>

        <div class="toggle-item">
          <label for="debugModeToggle">Debug Mode</label>
          <div class="toggle-switch">
            <input type="checkbox" id="debugModeToggle">
            <span class="slider"></span>
          </div>
        </div>
      </div>

      <!-- Debug Tools Section -->
      <div class="sidebar-section debug-only" id="debugToolsSection">
        <h3>Debug Tools</h3>

        <div class="debug-action-buttons">
          <button id="debugFilesBtn" class="debug-action-button">
            <span class="action-icon">🗂️</span>
            <span class="action-text">Debug Files</span>
          </button>

          <button id="debugSignaturesBtn" class="debug-action-button">
            <span class="action-icon">🔍</span>
            <span class="action-text">Debug Signatures</span>
          </button>

          <button id="debugTransactionsBtn" class="debug-action-button">
            <span class="action-icon">📊</span>
            <span class="action-text">Debug Transactions</span>
          </button>

          <button id="saveLogBtn" class="debug-action-button">
            <span class="action-icon">💾</span>
            <span class="action-text">Save Log</span>
          </button>

          <button id="resetAppBtn" class="debug-action-button danger">
            <span class="action-icon">🔄</span>
            <span class="action-text">Reset App</span>
          </button>
        </div>
      </div>

      <!-- About -->
      <div class="sidebar-section">
        <p>Expense Tracker v1.0</p>
        <p>Manage your finances locally</p>
      </div>
    </div>
  </aside>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Main Content -->
  <main class="main-content" id="mainContent">
    <!-- Charts Section -->
    <div class="section" id="chartsSection">
      <div class="section-header">
        <h2>Financial Overview</h2>
        <div class="chart-controls">
          <div class="chart-filters">
            <select id="chartPeriodSelect" class="filter-select">
              <option value="all">All Time</option>
              <option value="month">This Month</option>
              <option value="quarter">This Quarter</option>
              <option value="year">This Year</option>
            </select>
            <select id="chartCurrencySelect" class="filter-select">
              <option value="all">All Currencies</option>
            </select>
          </div>

          <div class="chart-toggles debug-only">
            <button id="toggleIncomeExpenseChart" class="chart-toggle-btn active" data-chart="incomeExpenseChart">
              Income/Expense
            </button>
            <button id="toggleExpenseCategoryChart" class="chart-toggle-btn active" data-chart="expenseCategoryChart">
              Categories
            </button>
            <button id="toggleTimelineChart" class="chart-toggle-btn active" data-chart="timelineChart">
              Timeline
            </button>
          </div>
        </div>
      </div>

      <div class="charts-grid">
        <!-- Income vs Expenses Chart -->
        <div class="chart-wrapper income-expense-chart" id="incomeExpenseChartWrapper">
          <h3>Income vs Expenses</h3>
          <canvas id="incomeExpenseChart" width="400" height="300"></canvas>
        </div>

        <!-- Expense Category Chart -->
        <div class="chart-wrapper expense-category-chart" id="expenseCategoryChartWrapper">
          <h3>Expense Categories</h3>
          <canvas id="expenseCategoryChart" width="400" height="300"></canvas>
        </div>

        <!-- Timeline Chart -->
        <div class="chart-wrapper timeline-chart" id="timelineChartWrapper">
          <h3>Financial Timeline</h3>
          <canvas id="timelineChart" width="800" height="400"></canvas>
        </div>
      </div>
    </div>

    <!-- Transactions Section -->
    <div class="section" id="transactionsSection">
      <div class="section-header">
        <h2>Transactions</h2>
        <div class="section-actions">
          <button id="editCategoriesBtn" class="button secondary-btn debug-only" title="Manage expense categories">
            <span class="button-icon">🏷️</span>
            Manage Categories
          </button>
        </div>
      </div>

      <div class="section-content">
        <!-- Category Filter Buttons -->
        <div class="category-filter-section">
          <h3>Filter by Category</h3>
          <div id="categoryButtons" class="category-buttons-container">
            <!-- Category buttons will be rendered here -->
          </div>
        </div>

        <!-- Transaction Table Container -->
        <div id="transactionTableContainer" class="transaction-table-container">
          <!-- Filter section will be added here dynamically -->
          <!-- Transaction table will be rendered here -->
        </div>
      </div>
    </div>
  </main>

  <!-- Load main application -->
  <script type="module" src="main.js"></script>
</body>

</html>
